<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>AR Fire Safety Training Module</title>

  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    /* UI ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î */
    #ui {
      position: fixed;
      bottom: 20px;
      left: 0;
      width: 100%;
      text-align: center;
      z-index: 10;
      pointer-events: none; /* ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏ó‡∏∞‡∏•‡∏∏‡∏™‡πà‡∏ß‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ */
    }

    #ui-inner {
      pointer-events: auto; /* ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏î‡πâ */
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    button {
      padding: 10px 20px;
      font-size: 14px;
      border-radius: 20px;
      border: none;
      background: rgba(211, 47, 47, 0.9);
      color: white;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    button:active {
      background: #b71c1c;
      transform: scale(0.95);
    }
  </style>

  <script>
    // Component ‡∏´‡∏°‡∏∏‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    AFRAME.registerComponent('auto-rotate', {
      tick: function () {
        this.el.object3D.rotation.y += 0.01;
      }
    });

    function hideAll() {
      document.querySelector('#ext').setAttribute('visible', false);
      document.querySelector('#alarm').setAttribute('visible', false);
      document.querySelector('#smoke').setAttribute('visible', false);
    }

    function showExtinguisher() {
      hideAll();
      document.querySelector('#ext').setAttribute('visible', true);
      const text = "FIRE EXTINGUISHER\n\nPurpose:\nUsed to control small fires.\n\nPASS Method:\nP - Pull the pin\nA - Aim at the base\nS - Squeeze the handle\nS - Sweep side to side";
      document.querySelector('#info').setAttribute('value', text);
    }

    function showAlarm() {
      hideAll();
      document.querySelector('#alarm').setAttribute('visible', true);
      const text = "FIRE ALARM\n\nPurpose:\nAlerts people during a fire.\n\nHow to use:\n1. Break glass/Press button\n2. Alarm will sound\n3. Evacuate immediately";
      document.querySelector('#info').setAttribute('value', text);
    }

    function showSmoke() {
      hideAll();
      document.querySelector('#smoke').setAttribute('visible', true);
      const text = "SMOKE DETECTOR\n\nPurpose:\nDetects smoke early.\n\nHow it works:\n- Detects particles\n- Triggers alarm\n\nImportant:\nNever cover or disable.";
      document.querySelector('#info').setAttribute('value', text);
    }
  </script>
</head>

<body style="margin: 0; overflow: hidden;">

  <div id="ui">
    <div id="ui-inner">
      <button onclick="showExtinguisher()">üßØ Extinguisher</button>
      <button onclick="showAlarm()">üö® Alarm</button>
      <button onclick="showSmoke()">üå´ Detector</button>
    </div>
  </div>

  <a-scene
    embedded
    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
    vr-mode-ui="enabled: false"
    renderer="logarithmicDepthBuffer: true;">

    <a-assets>
      <a-asset-item id="extModel" src="fire_extinguisher.glb"></a-asset-item>
      <a-asset-item id="alarmModel" src="fire_alarm.glb"></a-asset-item>
      <a-asset-item id="smokeModel" src="apollo_smoke_detector.glb"></a-asset-item>
    </a-assets>

    <a-marker preset="hiro">

      <a-entity light="type: ambient; color: #BBB"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="-0.5 1 1"></a-entity>

      <a-entity id="ext" gltf-model="#extModel" scale="0.5 0.5 0.5" visible="true" auto-rotate></a-entity>
      <a-entity id="alarm" gltf-model="#alarmModel" scale="0.5 0.5 0.5" visible="false" auto-rotate></a-entity>
      <a-entity id="smoke" gltf-model="#smokeModel" scale="0.5 0.5 0.5" visible="false" auto-rotate></a-entity>

      <a-entity position="0 0.8 0" scale="2 2 2">
          <a-plane color="#000" opacity="0.7" width="2" height="1.5" position="1.2 0 0"></a-plane>
          <a-text id="info"
                  value="Scan Marker to Start"
                  align="center"
                  color="#FFF"
                  position="1.2 0 0.1"
                  width="1.8"
                  wrap-count="30">
          </a-text>
      </a-entity>

    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

</body>
</html>
